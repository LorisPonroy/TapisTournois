<template name="tournament">
    {{> pokerTournament}}
</template>

<template name="pokerTournament">
    <center><h1>{{tournament.title}}</h1></center>
	<br>
	<div class="d-flex justify-content-center">
        <button class="btn btn-success js-start-tournament">▶</button>
		<h3>{{getFormatedTime tournament.time}}</h3>
		<button class="btn btn-danger js-stop-tournament">⏸</button>
	</div>
    <br>
    <div>
        <input id="input_shuffle_nbTables" type="number" min="1" placeholder="nombre de tables">
        <button class="btn btn-warning js-shuffle-tables">Melanger les tables</button>
        <button class="btn btn-info js-go-to-overview">Overview</button>
	</div>
	<br>
	<br>
    <button class="btn btn-success js-add-player-to-tournament">Ajouter Joueur</button>
    <select id="js-select-player">
        {{#each p in allPlayers}}
            <option value="{{p._id}}">{{p.pseudo}}</option>
        {{/each}}
    </select>
    <br>
    <table class="table table-dark table-striped">
        <thead>
            <tr>
            <th scope="col">Pseudo</th>
            <th scope="col">Etat</th>
            <th scope="col">Table</th>
            <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            {{#each p in tournament.playerStates}}
                {{> pokerPlayerItem playerState=p}}
            {{/each}}
        </tbody>
    </table>
    <br>
    <br>
    <button class="btn btn-success js-add-event-to-tournament">Ajouter Event</button>
    <select id="input_event_type" type="text">
        <option value="0">Pause</option>
        <option value="1">Augmentation Blind</option>
    </select>
	<input id="input_event_duration" type="number" min="1" placeholder="Durée (en minutes)">
    <input id="input_event_smallBlind" type="number" min="0" step="5" placeholder="Small Blind">
    <input id="input_event_bigBlind" type="number" min="0" step="5" placeholder="Big Blind">
    <br>
    <table class="table table-dark table-striped">
        <thead>
            <tr>
            <th scope="col">Type</th>
            <th scope="col">Durée</th>
            <th scope="col">Ecoulée</th>
            <th scope="col">Small Blind</th>
            <th scope="col">Big Blind</th>
            <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            {{#each e in tournament.events}}
                {{> pokerEventItem event=e tournament=tournament}}
            {{/each}}
        </tbody>
    </table>
    
</template>

<template name="pokerPlayerItem">
    <tr>
      <th scope="row"><a href="/edit/player/{{player._id}}">{{playerState.player.pseudo}}</a></th>
      <td>{{status playerState.status}}</td>
      <td>{{playerState.table}}</td>
      <td>
        {{#if statusIsChecking playerState.status}}
            <button class="btn btn-success js-check-in-player" value="{{playerState.player._id}}">Check in</button>
        {{else}}
            <button class="btn btn-danger js-check-off-player" value="{{playerState.player._id}}">Check off</button>
        {{/if}}
        <button value="{{playerState.player._id}}" class="btn btn-primary js-move-player">Move</button>
        <button value="{{playerState.player._id}}" class="btn btn-warning js-kill-player">Kill</button>
        <button value="{{playerState.player._id}}" class="btn btn-danger js-remove-player-from-tournament">Remove from tournament</button>
        </td>
    </tr>
</template>

<template name="pokerEventItem">
    <tr>
        <th scope="row">{{getTypeName event.type}}</th>
        <td>{{getFormatedTime event.duration}}</td>
        <td>{{isCurrentEvent tournament event}}</td>
        <td>{{event.smallBlind}}</td>
        <td>{{event.bigBlind}}</td>
        <td>
			<button value="{{event._id}}" class="btn btn-warning js-up-event">Up</button>
			<button value="{{event._id}}" class="btn btn-warning js-down-event">Down</button>
			<!--<button class="btn btn-primary">Edit</button>-->
			<button value="{{event._id}}" class="btn btn-danger js-remove-event-from-tournament">Delete</button>
        </td>
    </tr>
</template>